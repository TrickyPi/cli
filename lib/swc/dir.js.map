{"version":3,"sources":["../../src/swc/dir.ts"],"sourcesContent":["import slash from \"slash\";\nimport { existsSync, promises } from \"fs\";\nimport { dirname, relative, join } from \"path\";\nimport { CompileStatus } from \"./constants\";\nimport { CliOptions } from \"./options\";\nimport { compile } from \"./util\";\nimport { outputResult } from \"./compile\";\nimport {\n  globSources,\n  isCompilableExtension,\n  slitCompilableAndCopyable,\n  watchSources,\n} from \"./sources\";\n\nimport type { Options } from \"@swc/core\";\n\ndeclare module \"fs\" {\n  namespace promises {\n    /**\n     * For node > 14 we want to use rm instead of rmdir\n     * We need to augment node v12 types\n     */\n    function rm(dir: string, option: object): void;\n  }\n}\n\nconst { mkdir, rmdir, rm, copyFile, unlink } = promises;\n\nconst cwd = process.cwd();\nconst recursive = { recursive: true };\n\n/**\n * Removes the leading directory, including all parent relative paths\n */\nfunction stripComponents(filename: string) {\n  const components = filename.split(\"/\").slice(1);\n  if (!components.length) {\n    return filename;\n  }\n  while (components[0] === \"..\") {\n    components.shift();\n  }\n  return components.join(\"/\");\n}\n\nfunction getDest(filename: string, outDir: string, ext?: string) {\n  const relativePath = slash(relative(cwd, filename));\n  let base = stripComponents(relativePath);\n  if (ext) {\n    base = base.replace(/\\.\\w*$/, ext);\n  }\n  return join(outDir, base);\n}\n\nasync function handleCompile(\n  filename: string,\n  outDir: string,\n  sync: boolean,\n  swcOptions: Options\n) {\n  const dest = getDest(filename, outDir, \".js\");\n  const sourceFileName = slash(relative(dirname(dest), filename));\n\n  const options = { ...swcOptions, sourceFileName };\n\n  const result = await compile(filename, options, sync, dest);\n\n  if (result) {\n    await outputResult(result, filename, dest, options);\n    return CompileStatus.Compiled;\n  } else {\n    return CompileStatus.Omitted;\n  }\n}\n\nasync function handleCopy(filename: string, outDir: string) {\n  const dest = getDest(filename, outDir);\n  const dir = dirname(dest);\n\n  console.log(filename);\n  await mkdir(dir, recursive);\n  await copyFile(filename, dest);\n\n  return CompileStatus.Copied;\n}\n\nasync function beforeStartCompilation(cliOptions: CliOptions) {\n  const { outDir, deleteDirOnStart } = cliOptions;\n\n  if (deleteDirOnStart) {\n    const exists = await existsSync(outDir);\n    if (exists) {\n      rm ? await rm(outDir, recursive) : await rmdir(outDir, recursive);\n    }\n  }\n}\n\nasync function initialCompilation(cliOptions: CliOptions, swcOptions: Options) {\n  const {\n    includeDotfiles,\n    filenames,\n    copyFiles,\n    extensions,\n    outDir,\n    sync,\n    quiet,\n    watch,\n  } = cliOptions;\n\n  const results = new Map<string, CompileStatus>();\n\n  const start = process.hrtime();\n  const sourceFiles = await globSources(filenames, includeDotfiles);\n  const [compilable, copyable] = slitCompilableAndCopyable(\n    sourceFiles,\n    extensions,\n    swcOptions,\n    copyFiles\n  );\n\n  if (sync) {\n    for (const filename of compilable) {\n      try {\n        const result = await handleCompile(filename, outDir, sync, swcOptions);\n        results.set(filename, result);\n      } catch (err) {\n        console.error(err.message);\n        results.set(filename, CompileStatus.Failed);\n      }\n    }\n    for (const filename of copyable) {\n      try {\n        const result = await handleCopy(filename, outDir);\n        results.set(filename, result);\n      } catch (err) {\n        console.error(err.message);\n        results.set(filename, CompileStatus.Failed);\n      }\n    }\n  } else {\n    await Promise.all([\n      Promise.allSettled(\n        compilable.map(file =>\n          handleCompile(file, outDir, sync, swcOptions).catch(err => {\n            console.error(err.message);\n            throw err;\n          })\n        )\n      ),\n      Promise.allSettled(copyable.map(file => handleCopy(file, outDir))),\n    ]).then(([compiled, copied]) => {\n      compiled.forEach((result, index) => {\n        const filename = compilable[index];\n        if (result.status === \"fulfilled\") {\n          results.set(filename, result.value);\n        } else {\n          results.set(filename, CompileStatus.Failed);\n        }\n      });\n\n      copied.forEach((result, index) => {\n        const filename = copyable[index];\n        if (result.status === \"fulfilled\") {\n          results.set(filename, result.value);\n        } else {\n          results.set(filename, CompileStatus.Failed);\n        }\n      });\n    });\n  }\n  const end = process.hrtime(start);\n\n  let failed = 0;\n  let compiled = 0;\n  let copied = 0;\n  for (let [_, status] of results) {\n    switch (status) {\n      case CompileStatus.Compiled:\n        compiled += 1;\n        break;\n      case CompileStatus.Failed:\n        failed += 1;\n        break;\n      case CompileStatus.Copied:\n        copied += 1;\n        break;\n    }\n  }\n\n  if (!quiet && compiled + copied) {\n    let message = \"\";\n    if (compiled) {\n      message += `Successfully compiled: ${compiled} ${\n        compiled > 1 ? \"files\" : \"file\"\n      }`;\n    }\n    if (compiled && copied) {\n      message += \", \";\n    }\n    if (copied) {\n      message += `copied ${copied} ${copied > 1 ? \"files\" : \"file\"}`;\n    }\n    message += ` with swc (%dms)`;\n\n    console.log(message, (end[1] / 1000000).toFixed(2));\n  }\n\n  if (failed) {\n    console.log(\n      `Failed to compile ${failed} ${failed !== 1 ? \"files\" : \"file\"} with swc.`\n    );\n    if (!watch) {\n      throw new Error(\"Failed to compile\");\n    }\n  }\n}\n\nasync function watchCompilation(cliOptions: CliOptions, swcOptions: Options) {\n  const {\n    includeDotfiles,\n    filenames,\n    copyFiles,\n    extensions,\n    outDir,\n    quiet,\n    sync,\n  } = cliOptions;\n\n  const watcher = await watchSources(filenames, includeDotfiles);\n  watcher.on(\"ready\", () => {\n    if (!quiet) {\n      console.info(\"Watching for file changes.\");\n    }\n  });\n  watcher.on(\"unlink\", async filename => {\n    try {\n      if (isCompilableExtension(filename, extensions)) {\n        await unlink(getDest(filename, outDir, \".js\"));\n      } else if (copyFiles) {\n        await unlink(getDest(filename, outDir));\n      }\n    } catch (err) {\n      if (err.code !== \"ENOENT\") {\n        console.error(err.stack);\n      }\n    }\n  });\n  for (const type of [\"add\", \"change\"]) {\n    watcher.on(type, async filename => {\n      if (isCompilableExtension(filename, extensions)) {\n        try {\n          const start = process.hrtime();\n          const result = await handleCompile(\n            filename,\n            outDir,\n            sync,\n            swcOptions\n          );\n          if (!quiet && result === CompileStatus.Compiled) {\n            const end = process.hrtime(start);\n            console.log(\n              `Successfully compiled ${filename} with swc (%dms)`,\n              (end[1] / 1000000).toFixed(2)\n            );\n          }\n        } catch (err) {\n          console.error(err.message);\n        }\n      } else if (copyFiles) {\n        try {\n          const start = process.hrtime();\n          const result = await handleCopy(filename, outDir);\n          if (!quiet && result === CompileStatus.Copied) {\n            const end = process.hrtime(start);\n            console.log(\n              `Successfully copied ${filename} with swc (%dms)`,\n              (end[1] / 1000000).toFixed(2)\n            );\n          }\n        } catch (err) {\n          console.error(`Failed to copy ${filename}`);\n          console.error(err.message);\n        }\n      }\n    });\n  }\n}\n\nexport default async function dir({\n  cliOptions,\n  swcOptions,\n}: {\n  cliOptions: CliOptions;\n  swcOptions: Options;\n}) {\n  const { watch } = cliOptions;\n\n  await beforeStartCompilation(cliOptions);\n  await initialCompilation(cliOptions, swcOptions);\n\n  if (watch) {\n    await watchCompilation(cliOptions, swcOptions);\n  }\n}\n"],"names":["dir","mkdir","rmdir","rm","copyFile","unlink","cwd","process","recursive","stripComponents","filename","components","split","slice","length","shift","join","getDest","outDir","ext","relativePath","base","replace","handleCompile","sync","swcOptions","dest","sourceFileName","options","result","Compiled","Omitted","handleCopy","console","log","Copied","beforeStartCompilation","cliOptions","deleteDirOnStart","exists","initialCompilation","includeDotfiles","filenames","copyFiles","extensions","quiet","watch","results","Map","start","hrtime","sourceFiles","compilable","copyable","set","err","error","message","Failed","Promise","all","allSettled","map","file","catch","then","compiled","copied","forEach","index","status","value","end","failed","_","toFixed","Error","watchCompilation","watcher","on","info","code","stack","type"],"mappings":"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"}